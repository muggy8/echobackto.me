importScripts("ogg_encoder.js"),self.do_write_data=function(e,t){if(self.outputBufferSize-self.outputLength<t){self.outputBufferSize+=4096;var f=new Uint8Array(self.outputBufferSize);f.set(self.outputBuffer,0,self.outputLength),self.outputBuffer=f}emMem=new Uint8Array(Module.HEAPU8.buffer,e,t),self.outputBuffer.set(emMem,self.outputLength,t),self.outputLength+=t},self.addEventListener("message",function(e){var t=e.data;switch(t.cmd){case"init":self.outputBufferSize=4096,self.outputLength=0,self.outputBuffer=new Uint8Array(self.outputBufferSize),self.encoder=_ogg_encoder_init(t.sampleRate,.4);break;case"write":var f=[];f[0]=t.leftData.length*t.leftData.BYTES_PER_ELEMENT,f[1]=t.rightData.length*t.rightData.BYTES_PER_ELEMENT;var u=[];u[0]=Module._malloc(f[0]),u[1]=Module._malloc(f[1]);var r=[];r[0]=new Uint8Array(Module.HEAPU8.buffer,u[0],f[0]),r[1]=new Uint8Array(Module.HEAPU8.buffer,u[1],f[1]),r[0].set(new Uint8Array(t.leftData.buffer)),r[1].set(new Uint8Array(t.rightData.buffer)),_ogg_encoder_write(self.encoder,u[0],u[1],t.samplesCount),Module._free(u[0]),Module._free(u[1]);break;case"finish":_ogg_encoder_finish(self.encoder),self.postMessage({buffer:self.outputBuffer.buffer,outputLength:self.outputLength},[self.outputBuffer.buffer])}},!1);